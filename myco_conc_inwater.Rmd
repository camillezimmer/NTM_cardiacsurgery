---
title: "Mycobacterium concentrations in water"
author: "Camille Zimmer"
date: "2023-07-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#Clear environment
rm(list = ls())

#Load libraries
library(tidyverse)
library(dplyr)
library(fitdistrplus)
library(readxl)
library(mc2d)
library(VGAM)
```

```{r dummygrondbeefdata, fig.width=9, fig.height=9}
#non-normal dist 
# (Delignette-Muller & Dutang, 2015, 2020)
# https://www.jstatsoft.org/article/view/v064i04

#On selecting curve fitting:
# https://rstudio-pubs-static.s3.amazonaws.com/321514_6e8d1a04e2164ef7b56251eb1ffc19d8.html

data("groundbeef")
str(groundbeef)
plotdist(groundbeef$serving, histo = TRUE, demp = TRUE)

#Calculate skewness and kurtosis to investigate which distributions to use
descdist(groundbeef$serving, boot = 1000)

#Try different distributions
fw = fitdist(groundbeef$serving, "weibull") 
summary(fw)
fg = fitdist(groundbeef$serving, "gamma") 
summary(fg)
fln = fitdist(groundbeef$serving, "lnorm") 
summary(fln)

#Plots
par(mfrow = c(2, 2)) 
plot.legend = c("Weibull", "lognormal", "gamma")
denscomp(list(fw, fln, fg), legendtext = plot.legend) 
qqcomp(list(fw, fln, fg), legendtext = plot.legend) 
cdfcomp(list(fw, fln, fg), legendtext = plot.legend) 
ppcomp(list(fw, fln, fg), legendtext = plot.legend)
```